\subsection{The Roles involved} 

\begin{itemize}
    \item \textbf{User:} An entity that interacts with the wallet to request licenses and prove ownership of those.
    \item \textbf{Service Provider:} An entity offering an off-chain service that receives requests for licenses, and upon acceptance, issues them. It also provides the service upon verification that a service request is correct.
\end{itemize}

\subsection{The Elements involved} 

\begin{itemize}
    \item \textbf{Request:} TBD.

    \item \textbf{License:} A license is an asset that represents the right of a user to use a given service. The structure is as follows:

    $$\License = \{\type, \pos, \nonce, \enc, (\lpk, R)\}.$$

    where

    \begin{center}
        \begin{tabular}{ |c|c|c|c| } 
        \hline
        \textbf{Element} & \textbf{Type} & \textbf{Info.} \\
        \hline
        $\type$ & - & Can be transparent (0) or obfuscated (1). \\ 
        $\pos$ & - & It is the position of the license into a Merkle tree of licenses. \\ 
        $\nonce$ & - & It is a randomness needed to compute $\enc$. \\ 
        $\enc$ & - & It is a ciphertext of size 4. \\
        $(\lpk, R)$ & - & It is the public key of the license belonging to the user. \\
        \hline
        \end{tabular}
    \end{center}

    \item \textbf{Session Cookie:} A session cookie is a secret value (thus, always obfuscated) known only by the user and the SP. It contains a set of openings to a given set of commitments. The structure is as follows:

    $$\stoken = \{\pos, \nonce, \enc, (\lpk_{\mathsf{SP}}, R_{\mathsf{SP}})\}.$$

    where

    \begin{center}
        \begin{tabular}{ |c|c|c|c| } 
        \hline
        \textbf{Element} & \textbf{Type} & \textbf{Info.} \\
        \hline
        $\pos$ & - & It is the position of the license into a Merkle tree of session cookies. \\ 
        $\nonce$ & - & It is a randomness needed to compute $\enc$. \\ 
        $\enc$ & - & It is a ciphertext of size 3. \\
        $(\lpk_{\mathsf{sc}}, R_{\mathsf{sc}})$ & - & It is the license public key of the session cookie. \\
        \hline
        \end{tabular}
    \end{center}

\end{itemize}
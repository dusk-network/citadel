\subsection{The Roles involved} 

\begin{itemize}
    \item \textbf{User:} An entity that interacts with the wallet to request licenses and prove ownership of those.
    \item \textbf{Service Provider:} An entity offering an off-chain service that receives requests for licenses, and upon acceptance, issues them. It also provides the service upon verification that a service request is correct.
\end{itemize}

\subsection{The Elements involved} 

\begin{itemize}
    \item \textbf{Request:} A request includes the encryption of a stealth address belonging to the user, where the license has to be sent to, and a symmetric key. The structure is as follows:

    \begin{center}
        \begin{tabular}{ |c|c|c|c| } 
        \hline
        \textbf{Element} & \textbf{Type} & \textbf{Info.} \\
        \hline
        $(\rpk, R)$ & - & It is a stealth address of the SP. \\
        $\enc$ & - & It is a ciphertext of size 4. \\
        $\nonce$ & - & It is a randomness needed to compute $\enc$. \\ 
        \hline
        \end{tabular}
    \end{center}


    \item \textbf{License:} A license is an asset that represents the right of a user to use a given service. The structure is as follows:

    \begin{center}
        \begin{tabular}{ |c|c|c|c| } 
        \hline
        \textbf{Element} & \textbf{Type} & \textbf{Info.} \\
        \hline
        $(\lpk, R)$ & - & It is a stealth address of the user. \\
        $\enc$ & - & It is a ciphertext of size 4. \\
        $\nonce$ & - & It is a randomness needed to compute $\enc$. \\ 
        $\pos$ & - & It is the position of the license into a Merkle tree of licenses. \\ 
        \hline
        \end{tabular}
    \end{center}

    \item \textbf{LicenseProverParameters:} A prover needs some auxiliary parameters to compute the proof that nullifies a license when desired to be spent. The structure is as follows:

    \begin{center}
        \begin{tabular}{ |c|c|c|c| } 
        \hline
        \textbf{Element} & \textbf{Type} & \textbf{Info.} \\
        \hline
        $\lpk'$ & - & The license public key prime.\\ 
        $\lsig$ & - & The signature of the license. \\ 
        $\com_0^{hash}$ & - & A hash commitment of the public key of the SP. \\ 
        $\com_1$ & - & A Pedersen Commitment of the attributes. \\ 
        $\com_2$ & - & A Pedersen Commitment of the $c$ value. \\ 
        $\mathsf{tx\_hash}$ & - & The hash of the transaction calling the nullifying contract. \\ 
        $\mathsf{sig}_\mathsf{tx}$ & - & The signature of the transaction calling the nullifying contract. \\ 
        $\mathsf{nullifier}_\mathsf{lic}$ & - & The nullifier of the license. \\ 
        $\mathsf{merkle\_proof}$ & - & Membership proof of the license in the Merkle tree of licenses. \\ 

        \hline
        \end{tabular}
    \end{center}

    \item \textbf{Session:} A session is a public struct known only by all the validators. The structure is as follows:

    \begin{center}
        \begin{tabular}{ |c|c|c|c| } 
        \hline
        \textbf{Element} & \textbf{Type} & \textbf{Info.} \\
        \hline
        $(\spk, R)$ & - & It is a stealth address of the SP. \\ 
        $\lnullifier$ & - & The nullifier of a given license. \\ 
        $\com_0^{hash}$ & - & A hash commitment of the public key of the SP. \\ 
        $\com_1$ & - & A Pedersen Commitment of the attributes. \\ 
        $\com_2$ & - & A Pedersen Commitment of the $c$ value. \\ 
        \hline
        \end{tabular}
    \end{center}

    \item \textbf{Session Cookie:} A session cookie is a secret value known only by the user and the SP. It contains a set of openings to a given set of commitments. The structure is as follows:

    \begin{center}
        \begin{tabular}{ |c|c|c|c| } 
        \hline
        \textbf{Element} & \textbf{Type} & \textbf{Info.} \\
        \hline
        $\lnullifier$ & - & The nullifier of a given license. \\ 
        $\pk_{\SP}$ & - & The public key of the SP. \\ 
        $\attr$ & - & The attributes of the user. \\ 
        $c$ & - & The challenge value. \\ 
        $(\mathsf{s_0}, \mathsf{s_1}, \mathsf{s_2})$ & - & The randomness used to compute the commitments. \\
        \hline
        \end{tabular}
    \end{center}

\end{itemize}
\subsection{The Roles involved} 

\begin{itemize}
    \item \textbf{User:} An entity that interacts with the wallet to request licenses and prove ownership of those.
    \item \textbf{Service Provider (SP):} An entity offering an off-chain service that receives requests for licenses, and upon acceptance, issues them.
    \item \textbf{Session Service Provider (SSP):} It provides the service upon verification that a service request is correct. It can be the same individual that the SP or another one.
\end{itemize}

\subsection{The Elements involved} 

\begin{itemize}
    \item \textbf{Request:} A request includes the encryption of a stealth address belonging to the user, where the license has to be sent to, and a symmetric key. The structure is as follows:

    \begin{center}
        \begin{tabular}{ |c|c|c|c| } 
        \hline
        \textbf{Element} & \textbf{Type} & \textbf{Info.} \\
        \hline
        $(\rpk, R)$ & StealthAddress & It is a request stealth address of the SP. \\
        $\enc$ & PoseidonCipher & It is a ciphertext of size 6. \\
        $\nonce$ & BlsScalar & It is a randomness needed to compute $\enc$. \\ 
        \hline
        \end{tabular}
    \end{center}


    \item \textbf{License:} A license is an asset that represents the right of a user to use a given service. The structure is as follows:

    \begin{center}
        \begin{tabular}{ |c|c|c|c| } 
        \hline
        \textbf{Element} & \textbf{Type} & \textbf{Info.} \\
        \hline
        $(\lpk, R)$ & StealthAddress & It is a license stealth address of the user. \\
        $\enc$ & PoseidonCipher & It is a ciphertext of size 4. \\
        $\nonce$ & BlsScalar & It is a randomness needed to compute $\enc$. \\ 
        $\pos$ & BlsScalar & It is the position of the license into a Merkle tree of licenses. \\ 
        \hline
        \end{tabular}
    \end{center}

    \item \textbf{LicenseProverParameters:} A prover needs some auxiliary parameters to compute the proof that nullifies a license when desired to be spent. The structure is as follows:

    \begin{center}
        \begin{tabular}{ |c|c|c|c| } 
        \hline
        \textbf{Element} & \textbf{Type} & \textbf{Info.} \\
        \hline
        $\lpk$ & JubJubAffine & The license public key.\\ 
        $\lpk'$ & JubJubAffine & The license public key prime.\\ 
        $\lsig$ & Signature & The signature of the license. \\ 
        $\com_0^{hash}$ & BlsScalar & A hash commitment of the public key of the SP. \\ 
        $\com_1$ & JubJubExtended & A Pedersen Commitment of the attributes. \\ 
        $\com_2$ & JubJubExtended & A Pedersen Commitment of the $c$ value. \\ 
        $\mathsf{session\_hash}$ & BlsScalar & The hash of the public key of the SSP plus some randomness. \\ 
        $\mathsf{sig\_session\_hash}$ & dusk\_schnorr::Proof & The signature of the session hash. \\ 
        $\mathsf{merkle\_proof}$ & PoseidonBranch & Membership proof of the license in the Merkle tree of licenses. \\ 

        \hline
        \end{tabular}
    \end{center}

    \item \textbf{Session:} A session is a public struct known by all the validators. The structure is as follows:

    \begin{center}
        \begin{tabular}{ |c|c|c|c| } 
        \hline
        \textbf{Element} & \textbf{Type} & \textbf{Info.} \\
        \hline
        $\mathsf{session\_hash}$ & BlsScalar & The hash of the public key of the SSP plus some randomness. \\ 
        $\lnullifier$ & BlsScalar & The nullifier of a given license. \\ 
        $\com_0^{hash}$ & BlsScalar & A hash commitment of the public key of the SP. \\ 
        $\com_1$ & JubJubExtended & A Pedersen Commitment of the attributes. \\ 
        $\com_2$ & JubJubExtended & A Pedersen Commitment of the $c$ value. \\ 
        \hline
        \end{tabular}
    \end{center}

    \item \textbf{Session Cookie:} A session cookie is a secret value known only by the user and the SSP. It contains a set of openings to a given set of commitments. The structure is as follows:

    \begin{center}
        \begin{tabular}{ |c|c|c|c| } 
        \hline
        \textbf{Element} & \textbf{Type} & \textbf{Info.} \\
        \hline
        $\pk_{\mathsf{SSP}}$ & JubJubAffine & The public key of the SSP. \\
        $\mathsf{r}$ & BlsScalar & Randomness for computing the session hash. \\
        $\lnullifier$ & BlsScalar & The nullifier of a given license. \\ 
        $\pk_{\SP}$ & JubJubAffine & The public key of the SP. \\ 
        $\attr$ & JubJubScalar & The attributes of the user. \\ 
        $c$ & JubJubScalar & The challenge value. \\ 
        $\mathsf{s_0}$ & JubJubScalar & The randomness used to compute the commitment 0. \\
        $\mathsf{s_1}$ & BlsScalar & The randomness used to compute the commitment 1. \\
        $\mathsf{s_2}$ & BlsScalar & The randomness used to compute the commitment 2. \\
        \hline
        \end{tabular}
    \end{center}

\end{itemize}
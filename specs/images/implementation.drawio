<mxfile host="app.diagrams.net" modified="2023-11-02T15:42:19.738Z" agent="Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/119.0" etag="c5AUwwF_BhW-oEY4A0Qu" version="22.0.8" type="device">
  <diagram name="Page-1" id="2YBvvXClWsGukQMizWep">
    <mxGraphModel dx="1215" dy="653" grid="0" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="850" pageHeight="1100" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="u64HSYAH2522ybIrUDP--6" value="Blockchain" style="shape=umlLifeline;perimeter=lifelinePerimeter;whiteSpace=wrap;html=1;container=0;dropTarget=0;collapsible=0;recursiveResize=0;outlineConnect=0;portConstraint=eastwest;newEdgeStyle={&quot;edgeStyle&quot;:&quot;elbowEdgeStyle&quot;,&quot;elbow&quot;:&quot;vertical&quot;,&quot;curved&quot;:0,&quot;rounded&quot;:0};labelBackgroundColor=none;fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="262" y="140" width="100" height="530" as="geometry" />
        </mxCell>
        <mxCell id="u64HSYAH2522ybIrUDP--7" value="" style="html=1;points=[];perimeter=orthogonalPerimeter;outlineConnect=0;targetShapes=umlLifeline;portConstraint=eastwest;newEdgeStyle={&quot;edgeStyle&quot;:&quot;elbowEdgeStyle&quot;,&quot;elbow&quot;:&quot;vertical&quot;,&quot;curved&quot;:0,&quot;rounded&quot;:0};labelBackgroundColor=none;" parent="u64HSYAH2522ybIrUDP--6" vertex="1">
          <mxGeometry x="45" y="70" width="10" height="100" as="geometry" />
        </mxCell>
        <mxCell id="aM9ryv3xv72pqoxQDRHE-1" value="User" style="shape=umlLifeline;perimeter=lifelinePerimeter;whiteSpace=wrap;html=1;container=0;dropTarget=0;collapsible=0;recursiveResize=0;outlineConnect=0;portConstraint=eastwest;newEdgeStyle={&quot;edgeStyle&quot;:&quot;elbowEdgeStyle&quot;,&quot;elbow&quot;:&quot;vertical&quot;,&quot;curved&quot;:0,&quot;rounded&quot;:0};labelBackgroundColor=none;fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="75" y="140" width="100" height="530" as="geometry" />
        </mxCell>
        <mxCell id="aM9ryv3xv72pqoxQDRHE-2" value="" style="html=1;points=[];perimeter=orthogonalPerimeter;outlineConnect=0;targetShapes=umlLifeline;portConstraint=eastwest;newEdgeStyle={&quot;edgeStyle&quot;:&quot;elbowEdgeStyle&quot;,&quot;elbow&quot;:&quot;vertical&quot;,&quot;curved&quot;:0,&quot;rounded&quot;:0};labelBackgroundColor=none;" parent="aM9ryv3xv72pqoxQDRHE-1" vertex="1">
          <mxGeometry x="45" y="70" width="10" height="442" as="geometry" />
        </mxCell>
        <mxCell id="aM9ryv3xv72pqoxQDRHE-5" value="License Provider&lt;br&gt;(LP)" style="shape=umlLifeline;perimeter=lifelinePerimeter;whiteSpace=wrap;html=1;container=0;dropTarget=0;collapsible=0;recursiveResize=0;outlineConnect=0;portConstraint=eastwest;newEdgeStyle={&quot;edgeStyle&quot;:&quot;elbowEdgeStyle&quot;,&quot;elbow&quot;:&quot;vertical&quot;,&quot;curved&quot;:0,&quot;rounded&quot;:0};fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="560" y="140" width="100" height="530" as="geometry" />
        </mxCell>
        <mxCell id="aM9ryv3xv72pqoxQDRHE-6" value="" style="html=1;points=[];perimeter=orthogonalPerimeter;outlineConnect=0;targetShapes=umlLifeline;portConstraint=eastwest;newEdgeStyle={&quot;edgeStyle&quot;:&quot;elbowEdgeStyle&quot;,&quot;elbow&quot;:&quot;vertical&quot;,&quot;curved&quot;:0,&quot;rounded&quot;:0};" parent="aM9ryv3xv72pqoxQDRHE-5" vertex="1">
          <mxGeometry x="45" y="82" width="10" height="75" as="geometry" />
        </mxCell>
        <mxCell id="4C9R4s7j7FgXvdK5kdj--1" value="License&lt;br&gt;smart contract" style="shape=umlLifeline;perimeter=lifelinePerimeter;whiteSpace=wrap;html=1;container=0;dropTarget=0;collapsible=0;recursiveResize=0;outlineConnect=0;portConstraint=eastwest;newEdgeStyle={&quot;edgeStyle&quot;:&quot;elbowEdgeStyle&quot;,&quot;elbow&quot;:&quot;vertical&quot;,&quot;curved&quot;:0,&quot;rounded&quot;:0};fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="411" y="140" width="100" height="530" as="geometry" />
        </mxCell>
        <mxCell id="4C9R4s7j7FgXvdK5kdj--5" value="Citadel Protocol Implementation" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=28;" parent="1" vertex="1">
          <mxGeometry x="72" y="84" width="458" height="30" as="geometry" />
        </mxCell>
        <mxCell id="4C9R4s7j7FgXvdK5kdj--11" value="use_license()" style="html=1;verticalAlign=bottom;endArrow=block;rounded=0;fontSize=12;exitX=0.9;exitY=0.427;exitDx=0;exitDy=0;exitPerimeter=0;" parent="1" target="4C9R4s7j7FgXvdK5kdj--2" edge="1">
          <mxGeometry width="80" relative="1" as="geometry">
            <mxPoint x="129" y="425.34000000000015" as="sourcePoint" />
            <mxPoint x="451" y="425.34000000000015" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4C9R4s7j7FgXvdK5kdj--13" value="" style="html=1;verticalAlign=bottom;endArrow=block;rounded=0;fontSize=12;startArrow=none;" parent="1" edge="1">
          <mxGeometry y="80" width="80" relative="1" as="geometry">
            <mxPoint x="470" y="463" as="sourcePoint" />
            <mxPoint x="470" y="463" as="targetPoint" />
            <mxPoint x="-80" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4C9R4s7j7FgXvdK5kdj--2" value="" style="html=1;points=[];perimeter=orthogonalPerimeter;outlineConnect=0;targetShapes=umlLifeline;portConstraint=eastwest;newEdgeStyle={&quot;edgeStyle&quot;:&quot;elbowEdgeStyle&quot;,&quot;elbow&quot;:&quot;vertical&quot;,&quot;curved&quot;:0,&quot;rounded&quot;:0};" parent="1" vertex="1">
          <mxGeometry x="456" y="425" width="10" height="60" as="geometry" />
        </mxCell>
        <mxCell id="NpgnE28sU-lu2zKAIgDs-9" value="Note: License Contract maintains:&lt;br&gt;&lt;ul&gt;&lt;li&gt;list of sessions&lt;br&gt;&lt;/li&gt;&lt;li&gt;Map of licenses&lt;/li&gt;&lt;li&gt;&lt;span style=&quot;&quot;&gt;Merkle tree of license hashes&lt;/span&gt;&lt;/li&gt;&lt;/ul&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;labelBackgroundColor=#E6FFCC;fontSize=12;labelBorderColor=default;shadow=0;" parent="1" vertex="1">
          <mxGeometry x="75" y="829" width="185" height="70" as="geometry" />
        </mxCell>
        <mxCell id="LKPpiPYNY-GA1jOvfXVS-2" value="request_license()" style="html=1;verticalAlign=bottom;endArrow=block;rounded=0;fontSize=12;" parent="1" target="u64HSYAH2522ybIrUDP--7" edge="1">
          <mxGeometry width="80" relative="1" as="geometry">
            <mxPoint x="130" y="213" as="sourcePoint" />
            <mxPoint x="365" y="213" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="LKPpiPYNY-GA1jOvfXVS-4" value="get_license_request()" style="html=1;verticalAlign=bottom;endArrow=open;dashed=1;endSize=8;rounded=0;fontSize=12;" parent="1" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="605" y="226" as="sourcePoint" />
            <mxPoint x="317" y="226" as="targetPoint" />
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="LKPpiPYNY-GA1jOvfXVS-5" value="&amp;nbsp;blockchain transaction" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;labelBackgroundColor=#E5CCFF;fontSize=12;" parent="1" vertex="1">
          <mxGeometry x="156" y="217" width="130" height="15" as="geometry" />
        </mxCell>
        <mxCell id="LKPpiPYNY-GA1jOvfXVS-7" value="issue_license()" style="html=1;verticalAlign=bottom;endArrow=open;dashed=1;endSize=8;rounded=0;fontSize=12;entryX=0.967;entryY=0.004;entryDx=0;entryDy=0;entryPerimeter=0;" parent="1" source="aM9ryv3xv72pqoxQDRHE-6" target="u64HSYAH2522ybIrUDP--8" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="610" y="269" as="sourcePoint" />
            <mxPoint x="375" y="269" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="LKPpiPYNY-GA1jOvfXVS-8" value="contract call blockchain transaction" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;labelBackgroundColor=#E5CCFF;fontSize=12;" parent="1" vertex="1">
          <mxGeometry x="470" y="299" width="130" height="30" as="geometry" />
        </mxCell>
        <mxCell id="LKPpiPYNY-GA1jOvfXVS-13" value="contract call blockchain transaction" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;labelBackgroundColor=#E5CCFF;fontSize=12;" parent="1" vertex="1">
          <mxGeometry x="187.5" y="422" width="218" height="30" as="geometry" />
        </mxCell>
        <mxCell id="LKPpiPYNY-GA1jOvfXVS-16" value="request_service()" style="html=1;verticalAlign=bottom;endArrow=block;rounded=0;fontSize=12;" parent="1" edge="1">
          <mxGeometry width="80" relative="1" as="geometry">
            <mxPoint x="130" y="511.5" as="sourcePoint" />
            <mxPoint x="755" y="511.5" as="targetPoint" />
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="LKPpiPYNY-GA1jOvfXVS-19" value="" style="html=1;points=[];perimeter=orthogonalPerimeter;labelBackgroundColor=#99FF99;fontSize=12;" parent="1" vertex="1">
          <mxGeometry x="456" y="560" width="10" height="35" as="geometry" />
        </mxCell>
        <mxCell id="LKPpiPYNY-GA1jOvfXVS-20" value="get_session()" style="html=1;verticalAlign=bottom;endArrow=open;dashed=1;endSize=8;rounded=0;fontSize=12;entryX=1.05;entryY=0.063;entryDx=0;entryDy=0;entryPerimeter=0;" parent="1" edge="1">
          <mxGeometry x="0.0043" relative="1" as="geometry">
            <mxPoint x="755" y="561" as="sourcePoint" />
            <mxPoint x="466.49999999999955" y="561.0160000000001" as="targetPoint" />
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="LKPpiPYNY-GA1jOvfXVS-21" value="contract call blockchain query" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;labelBackgroundColor=#E5CCFF;fontSize=12;" parent="1" vertex="1">
          <mxGeometry x="469" y="563" width="281" height="20" as="geometry" />
        </mxCell>
        <mxCell id="LKPpiPYNY-GA1jOvfXVS-22" value="grant_service()" style="html=1;verticalAlign=bottom;endArrow=open;dashed=1;endSize=8;rounded=0;fontSize=12;" parent="1" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="755" y="641" as="sourcePoint" />
            <mxPoint x="130" y="641" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="LKPpiPYNY-GA1jOvfXVS-23" value="off-chain" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;labelBackgroundColor=#FFB366;fontSize=12;" parent="1" vertex="1">
          <mxGeometry x="398" y="640" width="85" height="30" as="geometry" />
        </mxCell>
        <mxCell id="vlMPqen3POPuIYCPH7TB-2" value="Note: contract method - issue_license() adds the license to a Merkle tree of licenses." style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;labelBackgroundColor=#E6FFCC;fontSize=12;labelBorderColor=default;shadow=0;" parent="1" vertex="1">
          <mxGeometry x="283" y="836" width="157" height="20" as="geometry" />
        </mxCell>
        <mxCell id="vlMPqen3POPuIYCPH7TB-3" value="Note: contract method - use_license() tries to verify the proof, if verified it adds a new session to a list of sessions, nullifies the license in a Merkle tree." style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;labelBackgroundColor=#E6FFCC;fontSize=12;labelBorderColor=default;shadow=0;" parent="1" vertex="1">
          <mxGeometry x="283" y="909" width="157" height="50" as="geometry" />
        </mxCell>
        <mxCell id="vlMPqen3POPuIYCPH7TB-4" value="Note: contract method - get_session() finds a session in a list of sessions for which the nullifier is the same as in the given session cookie nullifier, and then returns it." style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;labelBackgroundColor=#E6FFCC;fontSize=12;labelBorderColor=default;shadow=0;" parent="1" vertex="1">
          <mxGeometry x="461" y="859" width="150" height="20" as="geometry" />
        </mxCell>
        <mxCell id="vlMPqen3POPuIYCPH7TB-6" value="" style="html=1;verticalAlign=bottom;endArrow=block;rounded=0;fontSize=12;" parent="1" edge="1">
          <mxGeometry width="80" relative="1" as="geometry">
            <mxPoint x="467" y="594" as="sourcePoint" />
            <mxPoint x="755" y="594" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="u64HSYAH2522ybIrUDP--1" value="Service Provider&lt;br&gt;(SP)" style="shape=umlLifeline;perimeter=lifelinePerimeter;whiteSpace=wrap;html=1;container=0;dropTarget=0;collapsible=0;recursiveResize=0;outlineConnect=0;portConstraint=eastwest;newEdgeStyle={&quot;edgeStyle&quot;:&quot;elbowEdgeStyle&quot;,&quot;elbow&quot;:&quot;vertical&quot;,&quot;curved&quot;:0,&quot;rounded&quot;:0};fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="710" y="140" width="100" height="530" as="geometry" />
        </mxCell>
        <mxCell id="u64HSYAH2522ybIrUDP--2" value="" style="html=1;points=[];perimeter=orthogonalPerimeter;outlineConnect=0;targetShapes=umlLifeline;portConstraint=eastwest;newEdgeStyle={&quot;edgeStyle&quot;:&quot;elbowEdgeStyle&quot;,&quot;elbow&quot;:&quot;vertical&quot;,&quot;curved&quot;:0,&quot;rounded&quot;:0};" parent="u64HSYAH2522ybIrUDP--1" vertex="1">
          <mxGeometry x="45" y="341" width="10" height="166" as="geometry" />
        </mxCell>
        <mxCell id="u64HSYAH2522ybIrUDP--8" value="" style="html=1;points=[];perimeter=orthogonalPerimeter;rounded=0;shadow=0;labelBackgroundColor=#E6FFCC;labelBorderColor=default;fontSize=12;" parent="1" vertex="1">
          <mxGeometry x="456" y="295" width="10" height="94" as="geometry" />
        </mxCell>
        <mxCell id="u64HSYAH2522ybIrUDP--19" value="add license" style="edgeStyle=orthogonalEdgeStyle;html=1;align=left;spacingLeft=2;endArrow=block;rounded=0;fontSize=12;" parent="1" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="466" y="335" as="sourcePoint" />
            <Array as="points">
              <mxPoint x="496" y="335" />
              <mxPoint x="496" y="345" />
            </Array>
            <mxPoint x="466" y="345" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="u64HSYAH2522ybIrUDP--23" value="off-chain" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;labelBackgroundColor=#FFB366;fontSize=12;" parent="1" vertex="1">
          <mxGeometry x="398" y="508" width="85" height="30" as="geometry" />
        </mxCell>
        <mxCell id="u64HSYAH2522ybIrUDP--26" value="&lt;div&gt;get_license()&lt;/div&gt;" style="html=1;verticalAlign=bottom;endArrow=block;rounded=0;fontSize=12;exitX=0.9;exitY=0.427;exitDx=0;exitDy=0;exitPerimeter=0;" parent="1" edge="1">
          <mxGeometry width="80" relative="1" as="geometry">
            <mxPoint x="130" y="353.34000000000015" as="sourcePoint" />
            <mxPoint x="456" y="353" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="u64HSYAH2522ybIrUDP--27" value="" style="html=1;verticalAlign=bottom;endArrow=open;dashed=1;endSize=8;rounded=0;fontSize=12;" parent="1" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="457" y="387" as="sourcePoint" />
            <mxPoint x="130" y="387.0000000000001" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="u64HSYAH2522ybIrUDP--33" value="contract call blockchain query" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;labelBackgroundColor=#E5CCFF;fontSize=12;" parent="1" vertex="1">
          <mxGeometry x="190" y="350" width="213" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ubPo2E77o_TBrRNH7Evs-4" value="&lt;font style=&quot;font-size: 12px;&quot;&gt;&lt;i&gt;&lt;font face=&quot;Helvetica&quot;&gt;(scan for relevant requests)&lt;/font&gt;&lt;/i&gt;&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=20;fontFamily=Architects Daughter;" vertex="1" parent="1">
          <mxGeometry x="319" y="224" width="284" height="20" as="geometry" />
        </mxCell>
        <mxCell id="ubPo2E77o_TBrRNH7Evs-7" value="add session" style="edgeStyle=orthogonalEdgeStyle;html=1;align=left;spacingLeft=2;endArrow=block;rounded=0;fontSize=12;" edge="1" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="466" y="442" as="sourcePoint" />
            <Array as="points">
              <mxPoint x="496" y="442" />
              <mxPoint x="496" y="452" />
            </Array>
            <mxPoint x="466" y="452" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="ubPo2E77o_TBrRNH7Evs-8" value="request detected" style="edgeStyle=orthogonalEdgeStyle;html=1;align=left;spacingLeft=2;endArrow=block;rounded=0;fontSize=12;" edge="1" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="615" y="255" as="sourcePoint" />
            <Array as="points">
              <mxPoint x="645" y="255" />
              <mxPoint x="645" y="265" />
            </Array>
            <mxPoint x="615" y="265" as="targetPoint" />
          </mxGeometry>
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>

\subsection{The Roles Involved} 

\begin{itemize}
    \item \textbf{User:} an entity that interacts with the wallet to request licenses and prove ownership of those.
    \item \textbf{License Provider (LP):} an entity that receives requests for licenses, and upon acceptance, issues them.
    \item \textbf{Service Provider (SP):} the entity that provides a service upon verification that a service request is correct. The SP may be the same as the LP entity or a different one.
\end{itemize}

\subsection{The Elements Involved} 

\begin{itemize}
    \item \textbf{Request:} a request includes the encryption of a stealth address belonging to the user, where the license has to be sent to, and a symmetric key. The structure is as follows:

    \begin{center}
        \begin{tabular}{ | p{0.15\linewidth} | p{0.2\linewidth} | p{0.55\linewidth} | } 
        \hline
        \textbf{Element} & \textbf{Type} & \textbf{Info.} \\
        \hline
        $(\rpk, R_{\req})$ & StealthAddress & It is a request stealth address for the LP. \\
        $\enc$ & PoseidonCipher[6] & It is the encryption of a license stealth address for the user and a symmetric key. \\
        $\nonce$ & BlsScalar & Randomness needed to compute $\enc$. \\ 
        \hline
        \end{tabular}
    \end{center}

    \item \textbf{License:} a license is an asset that represents the right of a user to use a given service. The structure is as follows:

    \begin{center}
        \begin{tabular}{ | p{0.15\linewidth} | p{0.2\linewidth} | p{0.55\linewidth} | } 
        \hline
        \textbf{Element} & \textbf{Type} & \textbf{Info.} \\
        \hline
        $(\lpk, R_{\lic})$ & StealthAddress & It is a license stealth address of the user. \\
        $\enc$ & PoseidonCipher[4] & It is the encryption of the data of some user attributes and the signature of this data. \\
        $\nonce$ & BlsScalar & Randomness needed to compute $\enc$. \\ 
        $\pos$ & BlsScalar & It is the position of the license in the Merkle tree of licenses. \\ 
        \hline
        \end{tabular}
    \end{center}

    \item \textbf{LicenseProverParameters:} a prover needs some auxiliary parameters to compute the proof that proves the ownership of a license. Some of the items of this table are related to the session and session cookie elements. The structure is as follows:

    \begin{center}
        \begin{tabular}{ | p{0.15\linewidth} | p{0.2\linewidth} | p{0.55\linewidth} | } 
        \hline
        \textbf{Element} & \textbf{Type} & \textbf{Info.} \\
        \hline
        $\lpk$ & JubJubAffine & The license public key of the user.\\ 
        $\lpk'$ & JubJubAffine & A variation of the license public key of the user computed with a different generator.\\ 
        $\lsig$ & Signature & The signature of the license attributes data. \\ 
        $\com_0^{hash}$ & BlsScalar & A hash of the public key of the LP. \\ 
        $\com_1$ & JubJubExtended & A Pedersen commitment of the attributes data. \\ 
        $\com_2$ & JubJubExtended & A Pedersen commitment of the $c$ value. \\ 
        $\mathsf{session\_hash}$ & BlsScalar & The hash of the public key of the SP together with some randomness. \\ 
        $\mathsf{sig\_session\_hash}$ & dusk\_schnorr::Proof & The signature of the session hash signed by the user. \\ 
        $\mathsf{merkle\_proof}$ & PoseidonBranch & Membership proof of the license in the Merkle tree of licenses. \\ 

        \hline
        \end{tabular}
    \end{center}

    \item \textbf{Session:} a session is a public struct known by all the validators. The structure is as follows:

    \begin{center}
        \begin{tabular}{ | p{0.15\linewidth} | p{0.2\linewidth} | p{0.55\linewidth} | } 
        \hline
        \textbf{Element} & \textbf{Type} & \textbf{Info.} \\
        \hline
        $\mathsf{session\_hash}$ & BlsScalar & The hash of the public key of the SP together with some randomness. \\ 
        $\sessionid$ & BlsScalar & The id of a session open using a given license. \\ 
        $\com_0^{hash}$ & BlsScalar & A hash of the public key of the LP. \\ 
        $\com_1$ & JubJubExtended & A Pedersen commitment of the attributes data. \\ 
        $\com_2$ & JubJubExtended & A Pedersen commitment of the $c$ value. \\ 
        \hline
        \end{tabular}
    \end{center}

    \item \textbf{SessionCookie:} a session cookie is a secret value known only by the user and the SP. It contains a set of openings to a given set of commitments. The structure is as follows:

    \begin{center}
        \begin{tabular}{ | p{0.15\linewidth} | p{0.2\linewidth} | p{0.55\linewidth} | } 
        \hline
        \textbf{Element} & \textbf{Type} & \textbf{Info.} \\
        \hline
        $\pk_{\mathsf{SP}}$ & JubJubAffine & The public key of the SP. \\
        $r_\mathsf{session}$ & BlsScalar & Randomness for computing the session hash. \\
        $\sessionid$ & BlsScalar & The id of a session open using a given license. \\ 
        $\pk_{\LP}$ & JubJubAffine & The public key of the LP. \\ 
        $\attrdata$ & JubJubScalar & Specific data concerning the attributes of the user. \\ 
        $c$ & JubJubScalar & The challenge value. \\ 
        $\mathsf{s_0}$ & JubJubScalar & Randomness used to compute $\com_0^{hash}$. \\
        $\mathsf{s_1}$ & BlsScalar & Randomness used to compute $\com_1$. \\
        $\mathsf{s_2}$ & BlsScalar & Randomness used to compute $\com_2$. \\
        \hline
        \end{tabular}
    \end{center}

\end{itemize}